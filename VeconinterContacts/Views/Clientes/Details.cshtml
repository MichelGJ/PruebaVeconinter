@model VeconinterContacts.Models.Cliente

@{
    ViewData["Title"] = "Detalles";
}

<div class="row g-3">
    <div class="col-lg-4">
        <div class="card h-100">
            <div class="card-header">Cliente</div>
            <div class="card-body">
                <p class="mb-1"><strong>Nombre:</strong> @Model.Nombre</p>
                <p class="mb-1"><strong>Email:</strong> @Model.Email</p>
                <p class="mb-1"><strong>Teléfono:</strong> @Model.Telefono</p>
                <p class="mb-0"><strong>Empresa:</strong> @Model.Empresa</p>
            </div>
            <div class="card-footer d-flex gap-2">
                <a class="btn btn-secondary" asp-action="Index">Volver</a>
                <a class="btn btn-warning" asp-action="Edit" asp-route-id="@Model.Id">Editar</a>
            </div>
        </div>
    </div>

    <div class="col-lg-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span>Subclientes</span>
            </div>
            <div class="card-body p-0">
                <table class="table table-sm align-middle m-0">
                    <thead class="table-light"><tr><th>Nombre</th><th>Email</th><th>Teléfono</th><th class="text-end"></th></tr></thead>
                    <tbody>
                        @foreach (var s in Model.SubClientes)
                        {
                            <tr>
                                <td>@s.Nombre</td>
                                <td>@s.Email</td>
                                <td>@s.Telefono</td>
                                <td class="text-end">
                                    <a asp-controller="SubClientes" asp-action="Edit"
                                       asp-route-id="@s.Id"
                                       class="btn btn-sm btn-outline-warning">
                                        Editar
                                    </a>

                                    <form method="post" asp-action="DeleteSub" class="d-inline m-0">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="id" value="@s.Id" />
                                        <input type="hidden" name="clienteId" value="@Model.Id" />
                                        <button type="submit"
                                                class="btn btn-sm btn-outline-danger js-delete"
                                                data-message="¿Eliminar el subcliente '@s.Nombre'?">
                                            Eliminar
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <div class="card-footer">
                <form id="addSubForm" method="post" asp-action="AddSub" class="row g-2" novalidate>
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="clienteId" value="@Model.Id" />

                    <div class="col-md-4">
                        <input name="sub.Nombre" class="form-control" placeholder="Nombre" required maxlength="100" />
                    </div>

                    <div class="col-md-4">
                        <input name="sub.Email" type="email" class="form-control" placeholder="Email" required maxlength="100" />
                    </div>

                    <div class="col-md-3">
                        <input name="sub.Telefono" class="form-control" placeholder="Teléfono" required maxlength="11" />
                    </div>

                    <div class="col-md-1 d-grid">
                        <button class="btn btn-primary" type="submit">+</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <partial name="_FormLiveValidation"
             view-data='new ViewDataDictionary(ViewData) { { "FormSelector", "#addSubForm" } }' />
}